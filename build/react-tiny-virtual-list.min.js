!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["react","prop-types"],t):e.VirtualList=t(e.React,e.PropTypes)}(this,function(r,o){"use strict";var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};var e,t,n,v=function(){return(v=Object.assign||function(e){for(var t,o=1,i=arguments.length;o<i;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};var u="start",c="center",y="vertical",s="horizontal",d="requested",a=((e={})[y]="scrollTop",e[s]="scrollLeft",e),x=((t={})[y]="height",t[s]="width",t),f=((n={})[y]="top",n[s]="left",n),l=function(){function e(e){var t=e.itemCount,o=e.itemSizeGetter,i=e.estimatedItemSize;this.itemSizeGetter=o,this.itemCount=t,this.estimatedItemSize=i,this.itemSizeAndPositionData={},this.lastMeasuredIndex=-1}return e.prototype.updateConfig=function(e){var t=e.itemCount,o=e.estimatedItemSize;this.itemCount=t,this.estimatedItemSize=o},e.prototype.getLastMeasuredIndex=function(){return this.lastMeasuredIndex},e.prototype.getSizeAndPositionForIndex=function(e){if(e<0||e>=this.itemCount)throw Error("Requested index "+e+" is outside of range 0.."+this.itemCount);if(e>this.lastMeasuredIndex){for(var t=this.getSizeAndPositionOfLastMeasuredItem(),o=t.offset+t.size,i=this.lastMeasuredIndex+1;i<=e;i++){var r=this.itemSizeGetter(i);if(null==r||isNaN(r))throw Error("Invalid size returned for index "+i+" of value "+r);this.itemSizeAndPositionData[i]={offset:o,size:r},o+=r}this.lastMeasuredIndex=e}return this.itemSizeAndPositionData[e]},e.prototype.getSizeAndPositionOfLastMeasuredItem=function(){return 0<=this.lastMeasuredIndex?this.itemSizeAndPositionData[this.lastMeasuredIndex]:{offset:0,size:0}},e.prototype.getTotalSize=function(){var e=this.getSizeAndPositionOfLastMeasuredItem();return e.offset+e.size+(this.itemCount-this.lastMeasuredIndex-1)*this.estimatedItemSize},e.prototype.getUpdatedOffsetForIndex=function(e){var t=e.align,o=void 0===t?u:t,i=e.containerSize,r=e.currentOffset,n=e.targetIndex;if(i<=0)return 0;var s,a=this.getSizeAndPositionForIndex(n),f=a.offset,l=f-i+a.size;switch(o){case"end":s=l;break;case c:s=f-(i-a.size)/2;break;case u:s=f;break;default:s=Math.max(l,Math.min(f,r))}var d=this.getTotalSize();return Math.max(0,Math.min(d-i,s))},e.prototype.getVisibleRange=function(e){var t=e.containerSize,o=e.offset,i=e.overscanCount;if(0===this.getTotalSize())return{};var r=o+t,n=this.findNearestItem(o);if(void 0===n)throw Error("Invalid offset "+o+" specified");var s=this.getSizeAndPositionForIndex(n);o=s.offset+s.size;for(var a=n;o<r&&a<this.itemCount-1;)a++,o+=this.getSizeAndPositionForIndex(a).size;return i&&(n=Math.max(0,n-i),a=Math.min(a+i,this.itemCount-1)),{start:n,stop:a}},e.prototype.resetItem=function(e){this.lastMeasuredIndex=Math.min(this.lastMeasuredIndex,e-1)},e.prototype.findNearestItem=function(e){if(isNaN(e))throw Error("Invalid offset "+e+" specified");e=Math.max(0,e);var t=this.getSizeAndPositionOfLastMeasuredItem(),o=Math.max(0,this.lastMeasuredIndex);return t.offset>=e?this.binarySearch({high:o,low:0,offset:e}):this.exponentialSearch({index:o,offset:e})},e.prototype.binarySearch=function(e){for(var t=e.low,o=e.high,i=e.offset,r=0,n=0;t<=o;){if(r=t+Math.floor((o-t)/2),(n=this.getSizeAndPositionForIndex(r).offset)===i)return r;n<i?t=r+1:i<n&&(o=r-1)}return 0<t?t-1:0},e.prototype.exponentialSearch=function(e){for(var t=e.index,o=e.offset,i=1;t<this.itemCount&&this.getSizeAndPositionForIndex(t).offset<o;)t+=i,i*=2;return this.binarySearch({high:Math.min(t,this.itemCount-1),low:Math.floor(t/2),offset:o})},e}(),O={overflow:"auto",willChange:"transform",WebkitOverflowScrolling:"touch"},C={position:"relative",overflow:"hidden",width:"100%",minHeight:"100%"},p={position:"absolute",left:0,width:"100%"};function M(e,t,o,i){return r.createElement("div",v({ref:t},e),r.createElement("div",{style:o},i))}return function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i.sizeAndPositionManager=new l({itemCount:i.props.itemCount,itemSizeGetter:function(e){return i.getSize(e)},estimatedItemSize:i.getEstimatedItemSize()}),i.state={offset:i.props.scrollOffset||null!=i.props.scrollToIndex&&i.getOffsetForIndex(i.props.scrollToIndex)||0,scrollChangeReason:d},i.styleCache={},i.handleScroll=function(e){var t=i.props.onScroll,o=i.getNodeOffset();o<0||i.state.offset===o||e.target!==i.rootNode||(i.setState({offset:o,scrollChangeReason:"observed"}),"function"==typeof t&&t(o,e))},i.getRef=function(e){i.rootNode=e},i}return function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.scrollOffset,o=e.scrollToIndex;null!=t?this.scrollTo(t):null!=o&&this.scrollTo(this.getOffsetForIndex(o))},t.prototype.componentWillReceiveProps=function(e){var t=this.props,o=t.estimatedItemSize,i=t.itemCount,r=t.itemSize,n=t.scrollOffset,s=t.scrollToAlignment,a=t.scrollToIndex,f=e.scrollToIndex!==a||e.scrollToAlignment!==s,l=e.itemCount!==i||e.itemSize!==r||e.estimatedItemSize!==o;e.itemCount===i&&e.estimatedItemSize===o||this.sizeAndPositionManager.updateConfig({itemCount:e.itemCount,estimatedItemSize:this.getEstimatedItemSize(e)}),l&&this.recomputeSizes(),e.scrollOffset!==n?this.setState({offset:e.scrollOffset||0,scrollChangeReason:d}):"number"==typeof e.scrollToIndex&&(f||l)&&this.setState({offset:this.getOffsetForIndex(e.scrollToIndex,e.scrollToAlignment,e.itemCount),scrollChangeReason:d})},t.prototype.componentDidUpdate=function(e,t){var o=this.state,i=o.offset,r=o.scrollChangeReason;t.offset!==i&&r===d&&this.scrollTo(i)},t.prototype.getEstimatedItemSize=function(e){return void 0===e&&(e=this.props),e.estimatedItemSize||"number"==typeof e.itemSize&&e.itemSize||50},t.prototype.getNodeOffset=function(){var e=this.props.scrollDirection,t=void 0===e?y:e;return this.rootNode[a[t]]},t.prototype.scrollTo=function(e){var t=this.props.scrollDirection,o=void 0===t?y:t;this.rootNode[a[o]]=e},t.prototype.getOffsetForIndex=function(e,t,o){void 0===t&&(t=this.props.scrollToAlignment),void 0===o&&(o=this.props.itemCount);var i=this.props.scrollDirection,r=void 0===i?y:i;return(e<0||o<=e)&&(e=0),this.sizeAndPositionManager.getUpdatedOffsetForIndex({align:t,containerSize:this.props[x[r]],currentOffset:this.state&&this.state.offset||0,targetIndex:e})},t.prototype.getSize=function(e){var t=this.props.itemSize;return"function"==typeof t?t(e):Array.isArray(t)?t[e]:t},t.prototype.getStyle=function(e){var t,o=this.styleCache[e];if(o)return o;var i=this.props.scrollDirection,r=void 0===i?y:i,n=this.sizeAndPositionManager.getSizeAndPositionForIndex(e),s=n.size,a=n.offset;return this.styleCache[e]=v({},p,((t={})[x[r]]=s,t[f[r]]=a,t))},t.prototype.recomputeSizes=function(e){void 0===e&&(e=0),this.styleCache={},this.sizeAndPositionManager.resetItem(e)},t.prototype.render=function(){var e,t=this.props,o=(t.estimatedItemSize,t.height),i=t.overscanCount,r=void 0===i?3:i,n=t.renderItem,s=t.renderWrapper,a=void 0===s?M:s,f=(t.itemCount,t.itemSize,t.onItemsRendered),l=(t.onScroll,t.scrollDirection),d=void 0===l?y:l,u=(t.scrollOffset,t.scrollToIndex,t.scrollToAlignment,t.style),c=t.width,p=function(e,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(o[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&(o[i[r]]=e[i[r]])}return o}(t,["estimatedItemSize","height","overscanCount","renderItem","renderWrapper","itemCount","itemSize","onItemsRendered","onScroll","scrollDirection","scrollOffset","scrollToIndex","scrollToAlignment","style","width"]),h=this.state.offset,m=this.sizeAndPositionManager.getVisibleRange({containerSize:this.props[x[d]]||0,offset:h,overscanCount:r}),g=m.start,S=m.stop,z=[];if(void 0!==g&&void 0!==S){for(var I=g;I<=S;I++)z.push(n({index:I,style:this.getStyle(I)}));"function"==typeof f&&f({startIndex:g,stopIndex:S})}return a(v({},p,{onScroll:this.handleScroll,style:v({},O,u,{height:o,width:c})}),this.getRef,v({},C,((e={})[x[d]]=this.sizeAndPositionManager.getTotalSize(),e)),z)},t.defaultProps={overscanCount:3,renderWrapper:M,scrollDirection:y,width:"100%"},t.propTypes={estimatedItemSize:o.number,height:o.oneOfType([o.number,o.string]).isRequired,itemCount:o.number.isRequired,itemSize:o.oneOfType([o.number,o.array,o.func]).isRequired,onItemsRendered:o.func,overscanCount:o.number,renderItem:o.func.isRequired,renderWrapper:o.func,scrollOffset:o.number,scrollToIndex:o.number,scrollToAlignment:o.oneOf(["auto",u,c,"end"]),scrollDirection:o.oneOf([s,y]).isRequired,width:o.oneOfType([o.number,o.string]).isRequired},t}(r.PureComponent)});
